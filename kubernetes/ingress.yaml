
#====================================================================================
#üß± PART 1 ‚Äî Installing the Ingress Controller
#helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx
#helm repo update
#helm install ingress-nginx ingress-nginx/ingress-nginx \
#  --namespace ingress-nginx \
#  --create-namespace
#====================================================================================
# Helm installs:
# Deployment ‚Üí NGINX controller pods
# Service ‚Üí Usually type LoadBalancer
# ConfigMaps
# RBAC roles
# Webhook
# This creates a real NGINX reverse proxy inside Kubernetes.


#Access with LoadBalancer:
#Frontend: http://ae42926bd682a47d68475a9e04425cc4-1120037993.us-east-1.elb.amazonaws.com
#Backend API: http://ae42926bd682a47d68475a9e04425cc4-1120037993.us-east-1.elb.amazonaws.com/api


#üßæ PART 2 ‚Äî Creating Ingress Rules (wanderlust-ingress) ‚ö†Ô∏èThis does NOT install anything. This just creates routing rules‚ö†Ô∏è
#üî• How They Work Together
#Step 1 ‚Äî Internet Traffic Comes | Browser ‚Üí LoadBalancer IP

#That LoadBalancer was created by the ingress controller.

# Step 2 ‚Äî Traffic Hits NGINX Controller
# The controller checks: Do I have any Ingress rules? ||  It finds: wanderlust-ingress (in namespace wanderlust)

# Step 3 ‚Äî It Reads Your Rules
#You defined: Rule 1 ‚Üí /  ‚Üí frontend:5173


apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: wanderlust-ingress
  namespace: wanderlust
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
    nginx.ingress.kubernetes.io/proxy-body-size: "10m"
spec:
  ingressClassName: nginx
  rules:
    - http:
        paths:
          # Frontend - React/Vue app
          - path: /
            pathType: Prefix
            backend:
              service:
                name: frontend
                port:
                  number: 5173
          # Backend API routes
          - path: /api
            pathType: Prefix
            backend:
              service:
                name: backend
                port:
                  number: 8080
          # Health check endpoint
          - path: /health
            pathType: Exact
            backend:
              service:
                name: backend
                port:
                  number: 8080
